![s](http://i.imgur.com/o9a8jO7.jpg)

# weather-widgets

>Веб-сервис созданный по тестовому заданию. Язык вебсервиса - английский (так было удобнее)

[**Сервис запущен на собственном домене**](http://weather.orels1.tips)

Время выполнения - примерно 10-12 часов

## Задачи

- Сделать конструктор погодных виджетов с возможностью редактирования
  - Города прогноза
  - Количества дней прогноза
  - Ориентации виджета (горизонтальная/вертикальная)
- Кэшировать ответ от погодного API в Redis
- Позволить пользователям встраивать созданные виджеты
- Написать тесты

Дополнительная задача:
- Добавить систему авторизации. **Не выполнено** (не успел в связи с задачами по прошлой работе)

## Запуск

На машине должен быть установлен `nodejs 7.10`, `redis`

После клонирования репы - нужно установить зависимости

```
npm install
```

В переменных окружения нужно указать ключ APIXU (погодное API). [Ключ брать тут](https://www.apixu.com/)

### Переменные окружения

- APIXU_KEY - ключ к погодному API
- WEATHER_PORT - порт на котором запустить сервис (дефолтно - 3000)
- REDIS_PORT - порт Redis для подключения

Затем можно запустить сервис

```
node server.js
```

**Статика уже собрана и упакована, для удобства запуска**

## Технологии

- HTTP сервер собран с Express
- Для промисов используется bluebird
- Асинхронность через async/await
- Запросы к погодному API через fetch
- Фронт написан на ReactJS (без server-side rendering, для тестового показалось оверкиллом)
- Используется bootstrap (подкачивается через bower)
- Сборка всего - через webpack
- Эмбеды рендерятся сервером через pug.js, что дает примерно 50мс оверхэда, но при этом делается один запрос вместо двух

Если нужен пример моего кода с системой авторизации через passport, я делал ее в связке с JWT [вот тут](https://github.com/orels1/Red-Portal/blob/master/backend/api/v1/auth.js)


